# [Airflow](https://github.com/EugenyAstahov/Airflow/blob/main/Airflow.py)

Работа выполнена c использованием Jupyter Notebook, GitLab и AirFlow

---

Путь до файла указан вот так '/var/lib/airflow/airflow.git/dags/a.batalov/vgsales.csv'

Имеются следующие поля:

- Rank – место по объему продаж
- Name – название игры
- Platform – платформа, на которой выпущена игра
- Year – год релиза
- Genre – жанр
- Publisher – издатель
- NA_Sales – продажи в Северной Америке, в млн.
- EU_Sales – продажи в Европе, в млн.
- JP_Sales – продажи в Японии, в млн.
- Other_Sales – продажи в остальном мире, в млн.
- Global_Sales – продажи по всему миру, в млн.

---

## Задачи:

Определить год, за который будем смотреть данные.

Составить DAG из нескольких тасок, в результате которого нужно будет найти ответы на следующие вопросы:

- Какая игра была самой продаваемой в этом году во всем мире?
- Игры какого жанра были самыми продаваемыми в Европе? Перечислить все, если их несколько
- На какой платформе было больше всего игр, которые продались более чем миллионным тиражом в Северной Америке? Перечислить все, если их несколько
- У какого издателя самые высокие средние продажи в Японии? Перечислить все, если их несколько
- Сколько игр продались лучше в Европе, чем в Японии?

Оформить так, чтобы финальный таск писал в лог ответ на каждый вопрос. В DAG будет 7 тасков. По одному на каждый вопрос, таск с загрузкой данных и финальный таск который собирает все ответы. 

---

## Реализация проекта

 - Склонируем репозиторий
 - Создадаи ветку и перейдем в нее
 - Создадим .py файл и начнем выполнять в нем задачи
 - Определим год, за который будем смотреть данны. Сделаем это вот так: в питоне выполним 1994 + hash(f‘{login}') % 23,  где {login} - ваш логин (или же папка с дагами)
 - Составим DAG из нескольких тасок
 - Закоммитем и запушим изменения
 - Создадим merge request в терминале


## Результат

<div>
  <img src="https://github.com/EugenyAstahov/Logo/blob/main/AirFlow.png" width="500" height="250"/>&nbsp;
  <img src="https://github.com/EugenyAstahov/Logo/blob/main/Airflow2.png" width="800" height="250"/>&nbsp
</div>


